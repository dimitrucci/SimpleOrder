<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SimpleOrder</title>
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="main-page" id="showres">
    <div class="header">
        <div class="container">
            <div class="header-box">
                <a href="index.html" class="burger">
                    <img src="./img/burger.svg" alt="">
                </a>
                <div class="logo">
                    <img src="./img/logo.svg" alt="">
                </div>
                <a class="basket" href="bag.html">
                    <img src="./img/basket.svg" alt="">
                    <div class="count" id="count">
                        0
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div class="restaurant-header">
        <div class="container">
            <div class="restaurant-info">
                <div class="name" id="info-name">

                </div>
                <div class="tel" >
                    <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.8547 9.29198C11.5476 8.97223 11.1772 8.80127 10.7846 8.80127C10.3952 8.80127 10.0217 8.96906 9.7019 9.28881L8.70149 10.2861C8.61918 10.2417 8.53687 10.2006 8.45772 10.1594C8.34375 10.1024 8.23611 10.0486 8.1443 9.99163C7.20721 9.39645 6.3556 8.62082 5.53881 7.61724C5.14307 7.11704 4.87714 6.69598 4.68403 6.26859C4.94363 6.03115 5.18423 5.78421 5.4185 5.54677C5.50715 5.45813 5.59579 5.36632 5.68444 5.27768C6.34927 4.61285 6.34927 3.75174 5.68444 3.08691L4.82016 2.22263C4.72202 2.12449 4.62071 2.02318 4.52573 1.92187C4.33578 1.72559 4.13633 1.52298 3.93055 1.33303C3.62347 1.0291 3.25623 0.867645 2.86999 0.867645C2.48376 0.867645 2.11019 1.0291 1.7936 1.33303C1.79044 1.33619 1.79044 1.33619 1.78727 1.33936L0.710881 2.42524C0.305652 2.83047 0.0745449 3.32435 0.0238913 3.89737C-0.0520892 4.8218 0.220174 5.68291 0.42912 6.24643C0.941989 7.62991 1.70812 8.91208 2.851 10.2861C4.23764 11.9418 5.90605 13.2493 7.81189 14.1706C8.54004 14.5156 9.51195 14.924 10.5978 14.9937C10.6643 14.9968 10.734 15 10.7973 15C11.5286 15 12.1428 14.7372 12.624 14.2149C12.6272 14.2085 12.6335 14.2054 12.6366 14.1991C12.8013 13.9996 12.9912 13.8191 13.1907 13.626C13.3268 13.4962 13.4661 13.3601 13.6022 13.2176C13.9157 12.8916 14.0803 12.5117 14.0803 12.1223C14.0803 11.7297 13.9125 11.3529 13.5927 11.0364L11.8547 9.29198ZM12.9881 12.6256C12.9849 12.6256 12.9849 12.6288 12.9881 12.6256C12.8646 12.7586 12.738 12.8789 12.6018 13.0119C12.396 13.2081 12.1871 13.4139 11.9908 13.645C11.6711 13.9869 11.2943 14.1484 10.8005 14.1484C10.753 14.1484 10.7023 14.1484 10.6548 14.1452C9.71457 14.0851 8.84079 13.7178 8.18546 13.4044C6.39359 12.537 4.82016 11.3055 3.51266 9.7447C2.43311 8.44353 1.71129 7.24051 1.23325 5.94884C0.938823 5.16054 0.831184 4.54637 0.878672 3.96702C0.91033 3.59661 1.05279 3.28952 1.31556 3.02676L2.39511 1.9472C2.55024 1.80157 2.71487 1.72243 2.87632 1.72243C3.07577 1.72243 3.23723 1.84273 3.33854 1.94404C3.3417 1.9472 3.34487 1.95037 3.34804 1.95353C3.54115 2.13399 3.72477 2.32077 3.91789 2.52022C4.01603 2.62153 4.11734 2.72283 4.21865 2.82731L5.08292 3.69159C5.4185 4.02717 5.4185 4.33742 5.08292 4.673C4.99111 4.76481 4.90247 4.85662 4.81066 4.94526C4.54473 5.21753 4.29146 5.47079 4.01603 5.71773C4.0097 5.72406 4.00337 5.72723 4.0002 5.73356C3.72794 6.00582 3.77859 6.27176 3.83558 6.45221C3.83874 6.46171 3.84191 6.4712 3.84508 6.4807C4.06985 7.02523 4.38644 7.5381 4.86765 8.14911L4.87081 8.15227C5.74459 9.22866 6.66585 10.0676 7.68209 10.7103C7.81189 10.7926 7.94485 10.8591 8.07149 10.9224C8.18546 10.9794 8.2931 11.0332 8.38491 11.0902C8.39757 11.0965 8.41024 11.106 8.4229 11.1123C8.53054 11.1662 8.63184 11.1915 8.73632 11.1915C8.99908 11.1915 9.16371 11.0269 9.21753 10.973L10.3002 9.89033C10.4079 9.78269 10.5788 9.65289 10.7783 9.65289C10.9746 9.65289 11.136 9.77635 11.2342 9.88399C11.2373 9.88716 11.2373 9.88716 11.2405 9.89033L12.9849 11.6347C13.311 11.9576 13.311 12.29 12.9881 12.6256Z" fill="#1C1C1C"/>
                        <path d="M8.10631 3.56808C8.93576 3.70738 9.68923 4.09995 10.2907 4.70146C10.8923 5.30297 11.2817 6.05644 11.4241 6.8859C11.4589 7.09484 11.6394 7.24047 11.8452 7.24047C11.8705 7.24047 11.8927 7.23731 11.918 7.23414C12.1523 7.19615 12.3074 6.97454 12.2694 6.74027C12.0984 5.73669 11.6236 4.82176 10.8986 4.09678C10.1736 3.3718 9.25868 2.89692 8.25511 2.72597C8.02083 2.68798 7.80239 2.8431 7.76124 3.07421C7.72008 3.30532 7.87204 3.53009 8.10631 3.56808Z" fill="#FFA800"/>
                        <path d="M14.9826 6.61683C14.7008 4.96426 13.922 3.46048 12.7253 2.26378C11.5286 1.06709 10.0249 0.288292 8.37228 0.00653105C8.14117 -0.034625 7.92273 0.123668 7.88157 0.354775C7.84358 0.589048 7.99871 0.807492 8.23298 0.848648C9.70827 1.09875 11.0538 1.7984 12.1238 2.8653C13.1939 3.93535 13.8904 5.28084 14.1405 6.75613C14.1753 6.96508 14.3557 7.1107 14.5615 7.1107C14.5868 7.1107 14.609 7.10754 14.6343 7.10437C14.8654 7.06955 15.0237 6.84794 14.9826 6.61683Z" fill="#FFA800"/>
                    </svg>
                    <span id="info-tel">
                        +1 647-347-7347
                    </span>
                </div>
                <div class="address">
                    <svg width="20" height="20" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7.5 0C4.59223 0 2.22656 2.36566 2.22656 5.27344C2.22656 6.25588 2.4987 7.21465 3.01374 8.04645L7.19982 14.7923C7.28001 14.9215 7.42128 15 7.57321 15C7.57438 15 7.57553 15 7.5767 15C7.72995 14.9988 7.87151 14.9179 7.95023 14.7864L12.0296 7.9752C12.5162 7.16098 12.7734 6.22673 12.7734 5.27344C12.7734 2.36566 10.4078 0 7.5 0ZM11.2754 7.52396L7.56656 13.7164L3.76075 7.58338C3.33205 6.89104 3.09961 6.09229 3.09961 5.27344C3.09961 2.85029 5.07686 0.873047 7.5 0.873047C9.92314 0.873047 11.8975 2.85029 11.8975 5.27344C11.8975 6.068 11.6803 6.84633 11.2754 7.52396Z" fill="#1C1C1C"/>
                        <path d="M7.5 2.63672C6.04611 2.63672 4.86328 3.81955 4.86328 5.27344C4.86328 6.71804 6.02687 7.91016 7.5 7.91016C8.9913 7.91016 10.1367 6.70216 10.1367 5.27344C10.1367 3.81955 8.95389 2.63672 7.5 2.63672ZM7.5 7.03711C6.52567 7.03711 5.73633 6.24513 5.73633 5.27344C5.73633 4.30418 6.53074 3.50977 7.5 3.50977C8.46926 3.50977 9.26074 4.30418 9.26074 5.27344C9.26074 6.23095 8.48977 7.03711 7.5 7.03711Z" fill="#FFA800"/>
                    </svg>
                    <span id="info-address">

                    </span>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="menu-box" id="menuBox">
        </div>
        <div class="itemBox" id="itemBox">
            <div class="item">
                <div class="top">
                    <div class="img">
                        <img src="./img/sushi.png" alt="">
                    </div>
                    <div class="info">
                        <div class="name">
                            Philadelphia with Salmon
                        </div>
                        <div class="description">
                            Філадельфія з вугрем, філадельфія з креветкою, каліфорнія з лососем
                        </div>
                        <div class="info-value">
                            <div class="gram">
                                350 g
                            </div>
                            <div class="price">
                                10 $
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bottom">
                    <div class="count">
                        <div class="minus"></div>
                        <div class="count-i">
                            1
                        </div>
                        <div class="plus"></div>
                    </div>
                    <div class="btn">
                        Add to bag
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>

<script src="./js/jquery.min.js"></script>
<script>
    $(function () {
        let countBasket = $('#count');

        function countBasketF(data) {
            countBasket.text(data.length);
        }

        let basketlocal;
        if (localStorage.getItem('basket')) {
            basketlocal = JSON.parse(localStorage.getItem('basket'));
            countBasketF(basketlocal);
        } else {
            basketlocal = [];
        }
        let menuBox = $('#menuBox');
        let itemBox = $('#itemBox');
        let infoName = $('#info-name');
        let infoTel = $('#info-tel');
        let infoAddress = $('#info-address');
        let restaurant = JSON.parse(localStorage.getItem('restaurant'));
        let menu = JSON.parse(localStorage.getItem('menu'));

        $(document).on('click','.menu-item', function () {
            let indexData = $(this).data('index');
            $('.menu-item').removeClass('active');
            $(this).addClass('active');
            itemBox.empty();
            menu[indexData].items.forEach((item, index) => {
                insertMenuItems(item, index, indexData);
            })
        });

        $(document).on('click','.addBag', function () {
            if ($(this).parent().find('.count-i').attr('data-count') > 0) {
                let dataCount = $(this).parent().find('.count-i').attr('data-count');
                let mainId = $(this).attr('data-main-id');
                let secondId = $(this).attr('data-second-id');
                let obj = {
                    mainId: mainId,
                    secondId: secondId,
                    count: dataCount,
                    comment: '',
                    status: 'Get ready'
                };
                basketlocal.push(obj);
                localStorage.setItem('basket', JSON.stringify(basketlocal));
                countBasketF(basketlocal);
                $(this).parent().find('.count-i').attr('data-count', 0);
                $(this).parent().find('.count-i').text(0);
            }
        });

        $(document).on('click','.plus', function () {
            let dataCount = $(this).parent().find('.count-i').attr('data-count');
            dataCount++;
            $(this).parent().find('.count-i').text(dataCount);
            $(this).parent().find('.count-i').attr('data-count', dataCount)

        });
        $(document).on('click','.minus', function () {
            let dataCount = $(this).parent().find('.count-i').attr('data-count');
            if (dataCount === 0 || dataCount<=0) {
                return;
            } else {
                dataCount--;
                $(this).parent().find('.count-i').text(dataCount);
                $(this).parent().find('.count-i').attr('data-count', dataCount)
            }

        });

        menuBox.empty();
        itemBox.empty();
        menu.forEach((item, index) => {
            if(index === 0) {
                let menuItem = $(`
                        <div class='menu-item active' data-index="${index}">
                            ${item.name}
                        </div>`);
                menuBox.append(menuItem);
                item.items.forEach((item2, index2) => {
                    insertMenuItems(item2, index2, index)
                })
            } else {
                let menuItem = $(`
                        <div class='menu-item' data-index="${index}">
                            ${item.name}
                        </div>`);
                menuBox.append(menuItem);
            }
        });
        // console.log(restaurant);

        function insertMenuItems(item2, index2, indexData=null) {
            let itemsa = $(`

            <div class="item">
                <div class="top">
                    <div class="img">
                        <img src="./img/sushi.png" alt="">
                    </div>
                    <div class="info">
                        <div class="name">
                            ${item2.name}
                        </div>
                        <div class="description">
                            ${item2.description}
                        </div>
                        <div class="info-value">
                            <div class="gram">
                                ${item2.value} g
                            </div>
                            <div class="price">
                                ${item2.price} $
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bottom">
                    <div class="count">
                        <div class="minus"></div>
                        <div class="count-i" data-count="0">
                            0
                        </div>
                        <div class="plus"></div>
                    </div>
                    <div class="btn addBag" data-main-id="${indexData}" data-second-id="${index2}">
                        Add to bag
                    </div>
                </div>
            </div>

`);
            itemBox.append(itemsa);
        }

        infoName.text(restaurant.name);
        infoAddress.text(restaurant.formatted_address);

    })
</script>
</html>
